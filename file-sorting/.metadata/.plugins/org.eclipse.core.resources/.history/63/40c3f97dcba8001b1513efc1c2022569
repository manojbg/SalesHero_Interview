package com.saleshero.application.service;

import com.saleshero.service.ReadFileService;
import org.junit.Assert;
import org.junit.Test;
import org.junit.jupiter.api.function.Executable;
import org.junit.rules.ExpectedException;
import org.junit.jupiter.api.Assertions;
import org.junit.runner.RunWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.runners.MockitoJUnitRunner;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

@RunWith(MockitoJUnitRunner.class)
public class TestReadFileService {

    @InjectMocks
    private ReadFileService readFileService;

    @Mock
    private BufferedReader reader;

    @Mock
    private File file;
    
    @Test
    public void testReadingAFile() throws IOException
    {
    	String fileName = "files/filename.txt";
    	file = new File(fileName);
    	List<Integer> valueList = new ArrayList<Integer>();
    	 try 
    	 {
    	      FileWriter myWriter = new FileWriter(fileName);
    	      myWriter.write("12\n2324\n23432\n1\n353454\n-12321\n0");
    	      myWriter.close();
    	      reader = new BufferedReader(new FileReader(fileName));
    	      valueList = reader.lines().mapToInt(intValue -> Integer.parseInt(intValue.trim())).boxed().collect(Collectors.toList());
    	 } catch (IOException e) {
    	      e.printStackTrace();
    	 }
    	
        Mockito.when(readFileService.readFileValues(fileName)).thenReturn(valueList);
        Mockito.when(file.exists()).thenReturn(true);

        List<Integer> values = readFileService.readFileValues(fileName);
    }
    
    @Test(expected = FileNotFoundException.class)
    public void testExceptionThrownForReadingFile() throws IOException {
        //BufferedReader bufferedReader = Mockito.mock(BufferedReader.class);
    	String fileName = "files/nofilename.txt";
        Assertions.assertThrows(FileNotFoundException.class, () -> readFileService.readFileValues(fileName));
        //Assertions.assertEquals("File not found to read values : ", exception.getMessage());
    }
    
  /* @Test
    private void testNumberCountWhileRead()
    {

    }

    @Test
    private void testWritingToFile()
    {

    }

    @Test
    private void testExceptionThrownForWritingFile()
    {

    }

    @Test
    private void testNumberCountWhileWrite()
    {

    }*/
}
